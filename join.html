<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>انضمام مكتبة | الفهرس الليبي الموحد</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f8fafc; }
        .form-card { max-width: 600px; margin: 40px auto; background: white; padding: 30px; border-radius: 12px; shadow: 0 10px 25px rgba(0,0,0,0.1); border-top: 8px solid #1e3a8a; }
        label { block; margin-bottom: 5px; font-weight: 600; color: #1e293b; font-size: 13px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; margin-bottom: 15px; outline: none; }
        input:focus { border-color: #1e3a8a; ring: 2px #bfdbfe; }
    </style>
</head>
<body class="p-4">

    <div class="form-card shadow-xl">
        <div class="text-center mb-8">
            <h1 class="text-2xl font-bold text-blue-900">طلب انضمام مكتبة</h1>
            <p class="text-gray-500 text-sm">ساهم في بناء أكبر قاعدة بيانات للرسائل العلمية في ليبيا</p>
        </div>

        <form id="joinForm">
            <label>الاسم الرسمي للمكتبة (كما سيظهر في الفهرس)</label>
            <input type="text" id="libName" placeholder="مثلاً: مكتبة كلية الهندسة - جامعة طرابلس" required>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label>الجامعة التابعة لها</label>
                    <input type="text" id="libUni" placeholder="جامعة طرابلس" required>
                </div>
                <div>
                    <label>الكلية (إن وجد)</label>
                    <input type="text" id="libCollege" placeholder="كلية الآداب">
                </div>
            </div>

            <hr class="my-4">

            <label>رقم هاتف التواصل (واتساب)</label>
            <input type="tel" id="libPhone" placeholder="09XXXXXXXX" required>

            <label>البريد الإلكتروني الرسمي</label>
            <input type="email" id="libEmail" placeholder="library@uni.edu.ly">

            <hr class="my-4">

            <label>رابط موقع المكتبة على خرائط جوجل (Google Maps)</label>
            <div class="flex gap-2">
                <input type="url" id="libMap" placeholder="صق الرابط هنا..." required>
                <button type="button" onclick="window.open('https://www.google.com/maps', '_blank')" class="bg-gray-100 px-3 py-2 rounded text-[10px] border h-fit">افتح الخريطة</button>
            </div>
            <p class="text-[10px] text-gray-400 mb-4">* افتح الخرائط، حدد موقع مكتبتكم، ثم انسخ الرابط والصقه هنا.</p>

            <button type="submit" class="w-full bg-blue-900 text-white py-3 rounded-lg font-bold hover:bg-blue-800 transition shadow-lg">إرسال طلب الانضمام</button>
        </form>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAogBGo2_OzNito9D9AXVyAjSjmu-DYotc",
            authDomain: "libyan-theses-portal.firebaseapp.com",
            projectId: "libyan-theses-portal",
            databaseURL: "https://libyan-theses-portal-default-rtdb.europe-west1.firebasedatabase.app",
            appId: "1:80818219253:web:5ca7224ac6a5c8a7377dbc"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        document.getElementById('joinForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('libName').value,
                university: document.getElementById('libUni').value,
                college: document.getElementById('libCollege').value,
                phone: document.getElementById('libPhone').value,
                email: document.getElementById('libEmail').value,
                mapUrl: document.getElementById('libMap').value,
                status: "pending", // الطلبات تكون معلقة حتى توافق عليها
                joinDate: new Date().toISOString()
            };

            db.ref('libraries_directory').push(data).then(() => {
                alert('شكراً لكم! تم إرسال طلب الانضمام بنجاح. سيقوم فريق الفهرس بمراجعة البيانات وتفعيلها قريباً.');
                document.getElementById('joinForm').reset();
            });
        });
    </script>
</body>
</html>
