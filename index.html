<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ù„ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯ | Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-size: 11px; background-color: #f8fafc; font-family: sans-serif; padding: 5px; }
        .main-card { background: white; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-top: 4px solid #1e3a8a; }
        th { background-color: #1e3a8a; color: white; padding: 5px; border: 1px solid #cbd5e1; }
        td { padding: 4px; border: 1px solid #e2e8f0; text-align: center; }
        .search-input { width: 100%; padding: 6px; border: 2px solid #e2e8f0; border-radius: 4px; margin-bottom: 8px; outline: none; transition: 0.3s; }
        .search-input:focus { border-color: #1e3a8a; }
        .city-tag { background: #eff6ff; color: #1e40af; font-weight: bold; padding: 0 6px; border-radius: 4px; border: 1px solid #bfdbfe; }
    </style>
</head>
<body>

    <div class="main-card p-3 mb-2 flex justify-between items-center bg-white">
        <h1 class="text-blue-900 font-bold text-sm italic">Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ù„ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯ | Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</h1>
        <div id="stats" class="bg-green-100 text-green-800 px-3 py-0.5 rounded text-[10px] font-bold">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©...</div>
    </div>

    <div class="main-card p-2">
        <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„ØªØ¨Ø¹ÙŠØ©..." class="search-input">
        
        <div class="overflow-hidden rounded">
            <table class="w-full border-collapse" id="libTable">
                <thead>
                    <tr>
                        <th class="w-1/3">Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø©</th>
                        <th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th>
                        <th>Ø§Ù„ØªØ¨Ø¹ÙŠØ©</th>
                        <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ÙˆØ§Ù„Ù…ÙˆØ¬Ù‡Ø© Ù„Ø®Ø§Ø¯Ù… Ø£ÙˆØ±ÙˆØ¨Ø§
        const firebaseConfig = {
            apiKey: "AIzaSyAogBGo2_OzNito9D9AXVyAjSjmu-DYotc",
            authDomain: "libyan-theses-portal.firebaseapp.com",
            projectId: "libyan-theses-portal",
            databaseURL: "https://libyan-theses-portal-default-rtdb.europe-west1.firebasedatabase.app",
            appId: "1:80818219253:web:5ca7224ac6a5c8a7377dbc"
        };

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ø­ØµØ±Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯ approved_libraries
        db.ref('approved_libraries').on('value', (snapshot) => {
            const tbody = document.getElementById('tableBody');
            const stats = document.getElementById('stats');
            tbody.innerHTML = '';
            let count = 0;

            if (snapshot.exists()) {
                snapshot.forEach((child) => {
                    const data = child.val();
                    count++;
                    tbody.innerHTML += `
                        <tr class="hover:bg-blue-50 transition-colors">
                            <td class="font-bold text-blue-900 text-right pr-4 border-r-2 border-blue-900">${data.libraryName || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</td>
                            <td><span class="city-tag">${data.city || '-'}</span></td>
                            <td>${data.affiliation || '-'}</td>
                            <td><a href="${data.location}" target="_blank" class="text-blue-600 font-bold">ğŸ“ Ø¹Ø±Ø¶</a></td>
                        </tr>`;
                });
                stats.innerText = "Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©: " + count;
            } else {
                tbody.innerHTML = '<tr><td colspan="4" class="p-8 text-gray-400 italic">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</td></tr>';
                stats.innerText = "0 Ù…ÙƒØªØ¨Ø§Øª";
            }
        });

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹
        function filterTable() {
            const input = document.getElementById("searchInput");
            const filter = input.value.toLowerCase();
            const rows = document.getElementById("tableBody").getElementsByTagName("tr");

            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(filter) ? "" : "none";
            }
        }
    </script>
</body>
</html>
