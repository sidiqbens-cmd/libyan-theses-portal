<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุงูููุฑุณ ุงูููุจู ุงูููุญุฏ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: system-ui; background-color: #f1f5f9; font-size: 13px; }
        .nav-btn { cursor: pointer; padding: 10px; border-radius: 8px; transition: 0.3s; display: flex; align-items: center; gap: 8px; }
        .nav-btn:hover { background: #1e3a8a; color: white; }
        .active-tab { background: #1e3a8a; color: white; }
        iframe { width: 100%; height: calc(100vh - 120px); border: none; border-radius: 8px; background: white; }
    </style>
</head>
<body class="flex h-screen overflow-hidden">

    <div class="w-64 bg-white shadow-lg p-4 flex flex-col gap-4">
        <div class="text-center pb-4 border-b">
            <h1 class="text-blue-900 font-bold text-lg">ุงูููุฑุณ ุงูููุจู ุงูููุญุฏ</h1>
            <p class="text-gray-500 text-[10px]">ููุญุฉ ุงูุชุญูู ุงููุฑูุฒูุฉ ูููุฏุฑุงุก</p>
        </div>

        <nav class="flex flex-col gap-2">
            <div onclick="loadPage('admin.html', this)" class="nav-btn active-tab">
                <span>โ</span> ุฅุถุงูุฉ ุฑุณุงุฆู ุฌุฏูุฏุฉ
            </div>
            <div onclick="loadPage('requests.html', this)" class="nav-btn">
                <span>๐ข</span> ูุฑุงุฌุนุฉ ุทูุจุงุช ุงูุงูุถูุงู
            </div>
            <div onclick="loadPage('index.html', this)" class="nav-btn">
                <span>๐</span> ุงุณุชุนุฑุงุถ ุงูููุฑุณ ุงูุนุงู
            </div>
        </nav>

        <div class="mt-auto p-4 bg-blue-50 rounded-lg">
            <div class="text-blue-900 font-bold">ุงูุฅุญุตุงุฆูุงุช ุงููุญุธูุฉ:</div>
            <div id="statTheses" class="text-[11px]">ุงูุฑุณุงุฆู: ุฌุงุฑู ุงูุชุญููู...</div>
            <div id="statLibs" class="text-[11px]">ุงูููุชุจุงุช: ุฌุงุฑู ุงูุชุญููู...</div>
        </div>
    </div>

    <div class="flex-1 p-6 overflow-hidden">
        <header class="flex justify-between items-center mb-4">
            <h2 id="pageTitle" class="text-xl font-bold text-blue-900">ุฅุถุงูุฉ ุฑุณุงุฆู ุฌุฏูุฏุฉ</h2>
            <div class="text-gray-500 text-xs">ูุฑุญุจุงู ุจูุ ูุฏูุฑ ุงููุธุงู</div>
        </header>

        <div id="contentArea">
            <iframe id="mainFrame" src="admin.html"></iframe>
        </div>
    </div>

    <script>
        // ุฅุนุฏุงุฏุงุช Firebase ุงูุฎุงุตุฉ ุจู
        const firebaseConfig = {
            apiKey: "AIzaSyAogBGo2_OzNito9D9AXVyAjSjmu-DYotc",
            authDomain: "libyan-theses-portal.firebaseapp.com",
            projectId: "libyan-theses-portal",
            databaseURL: "https://libyan-theses-portal-default-rtdb.europe-west1.firebasedatabase.app",
            storageBucket: "libyan-theses-portal.appspot.com",
            messagingSenderId: "80818219253",
            appId: "1:80818219253:web:5ca7224ac6a5c8a7377dbc"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ุฏุงูุฉ ุงูุชููู ุจูู ุงูุตูุญุงุช
        function loadPage(page, element) {
            document.getElementById('mainFrame').src = page;
            document.getElementById('pageTitle').innerText = element.innerText.substring(3);
            
            // ุชุญุฏูุซ ุดูู ุงูุฃุฒุฑุงุฑ
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active-tab'));
            element.classList.add('active-tab');
        }

        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ููุฑุงู
        database.ref('theses').on('value', snap => {
            document.getElementById('statTheses').innerText = `ุฅุฌูุงูู ุงูุฑุณุงุฆู: ${snap.numChildren()}`;
        });
        database.ref('join_requests').on('value', snap => {
            const approved = Object.values(snap.val() || {}).filter(i => i.status === 'approved').length;
            document.getElementById('statLibs').innerText = `ุงูููุชุจุงุช ุงููุนุชูุฏุฉ: ${approved}`;
        });
    </script>
</body>
</html>
