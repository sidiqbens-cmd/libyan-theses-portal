<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุจูุงุจุฉ ุงูุฑุณุงุฆู ุงูุฌุงูุนูุฉ ุงูููุจูุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: system-ui; background-color: #f1f5f9; font-size: 12px; }
        .nav-btn { cursor: pointer; padding: 8px 12px; border-radius: 6px; transition: 0.2s; display: flex; align-items: center; gap: 8px; color: #475569; }
        .nav-btn:hover { background: #f1f5f9; color: #1e3a8a; }
        .active-tab { background: #1e3a8a !important; color: white !important; font-weight: bold; }
        iframe { width: 100%; height: calc(100vh - 70px); border: none; background: white; border-radius: 8px; shadow: sm; }
    </style>
</head>
<body class="flex h-screen overflow-hidden">

    <div class="w-60 bg-white shadow-xl flex flex-col">
        <div class="p-4 border-b bg-gray-50 text-center">
            <h1 class="text-blue-900 font-bold text-sm leading-tight">ุจูุงุจุฉ ุงูุฑุณุงุฆู ุงูุฌุงูุนูุฉ ุงูููุจูุฉ</h1>
            <p class="text-[10px] text-gray-500 mt-1">ููุญุฉ ุงูุชุญูู ุงููุฑูุฒูุฉ</p>
        </div>

        <nav class="p-3 flex flex-col gap-1">
            <div onclick="loadPage('admin.html', this)" class="nav-btn active-tab">
                <span>โ</span> ุฅุถุงูุฉ ุฑุณุงุฆู ุฌุฏูุฏุฉ
            </div>
            <div onclick="loadPage('requests.html', this)" class="nav-btn">
                <span>๐ข</span> ูุฑุงุฌุนุฉ ุทูุจุงุช ุงูุงูุถูุงู
            </div>
            <div onclick="loadPage('index.html', this)" class="nav-btn">
                <span>๐</span> ุงุณุชุนุฑุงุถ ุงูุจูุงุจุฉ ุงูุนุงู
            </div>
        </nav>

        <div class="mt-auto m-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
            <div class="text-blue-900 font-bold text-[10px] mb-2 border-b border-blue-200 pb-1">ุงูุฅุญุตุงุฆูุงุช ุงููุญุธูุฉ:</div>
            <div id="statTheses" class="text-[11px] text-blue-800 font-medium">ุฅุฌูุงูู ุงูุฑุณุงุฆู: --</div>
            <div id="statLibs" class="text-[11px] text-blue-800 font-medium">ุงูููุชุจุงุช ุงููุนุชูุฏุฉ: --</div>
        </div>
    </div>

    <div class="flex-1 flex flex-col bg-gray-100">
        <header class="h-12 bg-white border-b px-4 flex justify-between items-center shadow-sm">
            <h2 id="pageTitle" class="text-blue-900 font-bold">ุฅุถุงูุฉ ุฑุณุงุฆู ุฌุฏูุฏุฉ</h2>
            <div class="text-gray-400 text-[10px]">ูุฑุญุจุงู ุจูุ ูุฏูุฑ ุงููุธุงู</div>
        </header>
        <main class="p-3 flex-1 overflow-hidden">
            <iframe id="mainFrame" src="admin.html"></iframe>
        </main>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAogBGo2_OzNito9D9AXVyAjSjmu-DYotc",
            authDomain: "libyan-theses-portal.firebaseapp.com",
            projectId: "libyan-theses-portal",
            databaseURL: "https://libyan-theses-portal-default-rtdb.europe-west1.firebasedatabase.app",
            appId: "1:80818219253:web:5ca7224ac6a5c8a7377dbc"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        function loadPage(page, element) {
            document.getElementById('mainFrame').src = page;
            document.getElementById('pageTitle').innerText = element.innerText.substring(3);
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active-tab'));
            element.classList.add('active-tab');
        }

        // ุชุญุฏูุซ ุงูุฃุฑูุงู ูุจุงุดุฑุฉ
        database.ref('theses').on('value', snap => {
            document.getElementById('statTheses').innerText = `ุฅุฌูุงูู ุงูุฑุณุงุฆู: ${snap.numChildren()}`;
        });
        database.ref('join_requests').on('value', snap => {
            let approved = 0;
            snap.forEach(child => { if(child.val().status === 'approved') approved++; });
            document.getElementById('statLibs').innerText = `ุงูููุชุจุงุช ุงููุนุชูุฏุฉ: ${approved}`;
        });
    </script>
</body>
</html>
