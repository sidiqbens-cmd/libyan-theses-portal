<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© | Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ù„ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { background: #020617; color: #f1f5f9; font-family: 'Segoe UI', sans-serif; margin: 0; padding-top: 120px; }
        
        /* ØªØ«Ø¨ÙŠØª Ø§Ù„Ù‡ÙŠØ¯Ø± ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ */
        .sticky-header { 
            position: fixed; top: 0; left: 0; right: 0; z-index: 50;
            background: rgba(2, 6, 23, 0.9); backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(51, 65, 85, 0.5);
        }

        .lib-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); 
            gap: 20px; padding: 20px; 
        }

        .lib-card { 
            background: white; border-radius: 24px; color: #0f172a; 
            padding: 24px; border: 1px solid #e2e8f0; 
            transition: all 0.3s ease;
        }
        .lib-card:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body>

    <header class="sticky-header p-6 flex justify-between items-center max-w-7xl mx-auto shadow-2xl">
        <div>
            <h1 class="text-3xl font-black text-white italic">Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h1>
            <p class="text-sky-400 text-[10px] font-bold uppercase tracking-widest">Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ù†Ø¶Ù…Ø©</p>
        </div>
        <div class="flex gap-4">
            <div class="bg-emerald-500/10 px-6 py-2 rounded-2xl border border-emerald-500/20 text-center">
                <span class="text-[9px] text-emerald-500 font-black block uppercase">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¬Ù‡Ø§Øª</span>
                <b id="total-count" class="text-xl text-white">0</b>
            </div>
        </div>
    </header>

    <div id="libraries-container" class="lib-grid max-w-7xl mx-auto">
        </div>

    <script>
        const firebaseConfig = { databaseURL: "https://libyan-theses-portal-default-rtdb.europe-west1.firebasedatabase.app" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function loadApproved() {
            db.ref('approved_libraries').on('value', snap => {
                const container = document.getElementById('libraries-container');
                const counter = document.getElementById('total-count');
                container.innerHTML = "";
                let count = 0;

                snap.forEach(child => {
                    const lib = child.val();
                    count++;
                    
                    // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ: Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· Ø®Ø±ÙŠØ·Ø© Ù†Ø¶Ø¹ Ø¨Ø­Ø« Ø¬ÙˆØ¬Ù„ Ø¨Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø©
                    const mapUrl = lib.mapLocation && lib.mapLocation.includes('http') 
                                   ? lib.mapLocation 
                                   : `https://www.google.com/maps/search/${encodeURIComponent(lib.libName)}`;

                    container.innerHTML += `
                        <div class="lib-card">
                            <div class="mb-4 border-b border-slate-100 pb-4">
                                <h2 class="text-xl font-black text-slate-900 leading-tight">${lib.libName}</h2>
                                <span class="text-[10px] bg-sky-50 text-sky-600 px-3 py-1 rounded-full font-black mt-2 inline-block border border-sky-100">${lib.affiliation || 'Ù…Ø¤Ø³Ø³Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ©'}</span>
                            </div>

                            <div class="space-y-3 mb-6">
                                <div class="flex items-center gap-3 text-slate-500">
                                    <span class="text-lg">ğŸ‘¤</span>
                                    <div class="text-[11px] font-bold"><p class="text-[9px] text-slate-400 font-normal">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</p>${lib.manager || '-'}</div>
                                </div>
                                <div class="flex items-center gap-3 text-slate-500">
                                    <span class="text-lg">ğŸ“</span>
                                    <div class="text-[11px] font-bold"><p class="text-[9px] text-slate-400 font-normal">Ù‡Ø§ØªÙ Ø§Ù„ØªÙˆØ§ØµÙ„:</p><span dir="ltr">${lib.phone || '-'}</span></div>
                                </div>
                                <div class="flex items-center gap-3 text-slate-500">
                                    <span class="text-lg">ğŸ•’</span>
                                    <div class="text-[11px] font-bold text-emerald-600"><p class="text-[9px] text-slate-400 font-normal italic">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„:</p>${lib.workHours || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'}</div>
                                </div>
                            </div>

                            <div class="flex gap-2">
                                ${lib.facebook ? `<a href="${lib.facebook}" target="_blank" class="p-3 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-600 hover:text-white transition-all shadow-sm">ğŸ“˜</a>` : ''}
                                ${lib.website ? `<a href="${lib.website}" target="_blank" class="p-3 bg-sky-50 text-sky-500 rounded-xl hover:bg-sky-600 hover:text-white transition-all shadow-sm">ğŸŒ</a>` : ''}
                                <a href="${mapUrl}" target="_blank" class="flex-grow flex items-center justify-center gap-2 bg-slate-900 text-white py-3 rounded-xl font-black text-[11px] hover:bg-emerald-600 transition-all shadow-lg">
                                    ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
                                </a>
                            </div>
                        </div>
                    `;
                });
                counter.innerText = count;
            });
        }
        window.onload = loadApproved;
    </script>
</body>
</html>
