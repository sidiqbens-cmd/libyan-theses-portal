<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ù„ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f8fafc; font-size: 13px; }
        .admin-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 15px; }
        .json-area { background: #1e293b; color: #38bdf8; font-family: monospace; font-size: 11px; padding: 10px; border-radius: 5px; height: 200px; overflow-y: auto; }
    </style>
</head>
<body class="p-4">

    <div class="max-w-4xl mx-auto space-y-4">
        <div class="admin-card border-t-4 border-blue-600">
            <h2 class="text-lg font-bold text-blue-900 mb-2">Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <p class="text-gray-600 mb-4">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ø¶Ù…Ø§Ù† ØªÙˆØ§ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù….</p>
            
            <div class="flex gap-2">
                <button onclick="downloadTemplate()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded flex items-center gap-2">
                    <span>â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¥ÙƒØ³Ù„ Ø§Ù„Ù…ÙˆØ­Ø¯</span>
                </button>
                
                <input type="file" id="upload" accept=".xlsx, .xls" class="hidden">
                <button onclick="document.getElementById('upload').click()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    ğŸ“ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„
                </button>
            </div>
        </div>

        <div class="admin-card">
            <div class="flex justify-between items-center mb-2">
                <h3 class="font-bold">ÙƒÙˆØ¯ JSON Ø§Ù„Ù†Ø§ØªØ¬ (Ù„Ù„Ø³Ø® ÙÙŠ GitHub):</h3>
                <button onclick="copyJSON()" id="copyBtn" class="bg-gray-800 text-white text-xs px-3 py-1 rounded hidden">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
            </div>
            <pre id="jsonOutput" class="json-area">Ø§Ù†ØªØ¸Ø§Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù...</pre>
        </div>
    </div>

    <script>
        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…ÙˆØ­Ø¯ ÙÙˆØ±Ø§Ù‹
        function downloadTemplate() {
            const headers = [["Ø§Ù„Ø±Ù‚Ù…", "Ø§Ù„Ø¨Ø§Ø­Ø«", "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", "Ø§Ù„Ù…Ø´Ø±Ù", "Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©", "Ø§Ù„ÙƒÙ„ÙŠØ©", "Ø§Ù„Ù‚Ø³Ù…", "Ø§Ù„Ø¯Ø±Ø¬Ø©", "Ø§Ù„Ø­Ø§Ù„Ø©", "Ø§Ù„Ø±Ø§Ø¨Ø·", "Ù…Ù„Ø§Ø­Ø¸Ø§Øª"]];
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(headers);
            XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ø±Ø³Ø§Ø¦Ù„");
            XLSX.writeFile(wb, "Ù‚Ø§Ù„Ø¨_Ø§Ù„ÙÙ‡Ø±Ø³_Ø§Ù„Ù„ÙŠØ¨ÙŠ_Ø§Ù„Ù…ÙˆØ­Ø¯.xlsx");
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙˆØ¹
        document.getElementById('upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = function(event) {
                const data = new Uint8Array(event.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet);
                
                const output = document.getElementById('jsonOutput');
                output.innerText = JSON.stringify(json, null, 2);
                document.getElementById('copyBtn').classList.remove('hidden');
            };
            reader.readAsArrayBuffer(file);
        });

        function copyJSON() {
            const text = document.getElementById('jsonOutput').innerText;
            navigator.clipboard.writeText(text);
            alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯! Ø§Ø°Ù‡Ø¨ Ø§Ù„Ø¢Ù† Ù„Ù…Ù„Ù theses.json ÙÙŠ GitHub ÙˆÙ‚Ù… Ø¨Ù„ØµÙ‚Ù‡.");
        }
    </script>
</body>
</html>
